<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: TwitterAds::Analytics::ClassMethods
  
    &mdash; Documentation by YARD 0.9.12
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "TwitterAds::Analytics::ClassMethods";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (C)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../TwitterAds.html" title="TwitterAds (module)">TwitterAds</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Analytics.html" title="TwitterAds::Analytics (module)">Analytics</a></span></span>
     &raquo; 
    <span class="title">ClassMethods</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Module: TwitterAds::Analytics::ClassMethods
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  
  <dl>
    <dt>Included in:</dt>
    <dd><span class='object_link'><a href="../Tweet.html" title="TwitterAds::Tweet (module)">Tweet</a></span></dd>
  </dl>
  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/twitter-ads/resources/analytics.rb</dd>
  </dl>
  
</div>








  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#check_async_job_status-instance_method" title="#check_async_job_status (instance method)">#<strong>check_async_job_status</strong>(account, opts = {})  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Check async job status.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_async_job-instance_method" title="#create_async_job (instance method)">#<strong>create_async_job</strong>(account, ids, metric_groups, opts = {})  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create an asynchronous analytics job for a given ads account.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#fetch_async_job_data-instance_method" title="#fetch_async_job_data (instance method)">#<strong>fetch_async_job_data</strong>(data_url)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Fetch async job data for a completed job.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#stats-instance_method" title="#stats (instance method)">#<strong>stats</strong>(account, ids, metric_groups, opts = {})  &#x21d2; Array </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Pulls a list of metrics for a specified set of object IDs.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="check_async_job_status-instance_method">
  
    #<strong>check_async_job_status</strong>(account, opts = {})  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Check async job status. GET
/#<span class='object_link'><a href="../../TwitterAds.html#API_VERSION-constant" title="TwitterAds::API_VERSION (constant)">TwitterAds::API_VERSION</a></span>/stats/jobs/accounts/:account_id</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='const'><span class='object_link'><a href="../../TwitterAds.html" title="TwitterAds (module)">TwitterAds</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../LineItem.html" title="TwitterAds::LineItem (class)">LineItem</a></span></span><span class='period'>.</span><span class='id identifier rubyid_check_async_job_status'>check_async_job_status</span><span class='lparen'>(</span><span class='id identifier rubyid_account'>account</span><span class='comma'>,</span> <span class='label'>job_id:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>1357343438724431305</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>account</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Account.html" title="TwitterAds::Account (class)">Account</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The Account object instance.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>a customizable set of options</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    <p class="tag_title">Options Hash (<tt>opts</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:job_id</span>
          <span class="type">(<tt>String</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The starting time to use (default: 7 days ago).</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>A cursor of job statuses</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


162
163
164
165
166
167
168
169
170
171</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/twitter-ads/resources/analytics.rb', line 162</span>

<span class='kw'>def</span> <span class='id identifier rubyid_check_async_job_status'>check_async_job_status</span><span class='lparen'>(</span><span class='id identifier rubyid_account'>account</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='comment'># set default values
</span>  <span class='id identifier rubyid_job_ids'>job_ids</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='symbol'>:job_ids</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_params'>params</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:job_ids</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>Array</span><span class='period'>.</span><span class='id identifier rubyid_wrap'>wrap</span><span class='lparen'>(</span><span class='id identifier rubyid_job_ids'>job_ids</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>,</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_job_ids'>job_ids</span>

  <span class='id identifier rubyid_resource'>resource</span> <span class='op'>=</span> <span class='kw'>self</span><span class='op'>::</span><span class='const'>RESOURCE_ASYNC_STATS</span> <span class='op'>%</span> <span class='lbrace'>{</span> <span class='label'>account_id:</span> <span class='id identifier rubyid_account'>account</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_request'>request</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Request.html" title="TwitterAds::Request (class)">Request</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Request.html#initialize-instance_method" title="TwitterAds::Request#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_account'>account</span><span class='period'>.</span><span class='id identifier rubyid_client'>client</span><span class='comma'>,</span> <span class='symbol'>:get</span><span class='comma'>,</span> <span class='id identifier rubyid_resource'>resource</span><span class='comma'>,</span> <span class='label'>params:</span> <span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span>
  <span class='const'><span class='object_link'><a href="../Cursor.html" title="TwitterAds::Cursor (class)">Cursor</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Cursor.html#initialize-instance_method" title="TwitterAds::Cursor#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='id identifier rubyid_request'>request</span><span class='comma'>,</span> <span class='label'>init_with:</span> <span class='lbracket'>[</span><span class='id identifier rubyid_account'>account</span><span class='rbracket'>]</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_async_job-instance_method">
  
    #<strong>create_async_job</strong>(account, ids, metric_groups, opts = {})  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Create an asynchronous analytics job for a given ads account. A job_id is
returned, which you can use to poll the GET stats/jobs/accounts/:account_id
endpoint, checking until the job is successful.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_ids'>ids</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>7o4em</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>oc9ce</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>1c5lji</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
<span class='id identifier rubyid_metric_groups'>metric_groups</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='const'>MetricGroups</span><span class='period'>.</span><span class='const'>MOBILE_CONVERSION</span><span class='comma'>,</span> <span class='const'>MetricGroups</span><span class='period'>.</span><span class='const'>ENGAGEMENT</span><span class='rbracket'>]</span>
<span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_create_async_job'>create_async_job</span><span class='lparen'>(</span><span class='id identifier rubyid_account'>account</span><span class='comma'>,</span> <span class='id identifier rubyid_ids'>ids</span><span class='comma'>,</span> <span class='id identifier rubyid_metric_groups'>metric_groups</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>account</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Account.html" title="TwitterAds::Account (class)">Account</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The Account object instance.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>ids</span>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A collection of object IDs being targeted.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>metric_groups</span>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A collection of metric_groups to be fetched.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>An optional Hash of extended options.</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    
    
    
    
    <p class="tag_title">Options Hash (<tt>opts</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:start_time</span>
          <span class="type">(<tt>Time</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The starting time to use (default: 7 days ago).</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:end_time</span>
          <span class="type">(<tt>Time</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The end time to use (default: now).</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:granularity</span>
          <span class="type">(<tt>Symbol</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The granularity to use (default: :hour).</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:placement</span>
          <span class="type">(<tt>Symbol</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The placement of entity (default: ALL_ON_TWITTER).</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:segmentation_type</span>
          <span class="type">(<tt>Symbol</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The segmentation type to use (default: none).</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>The response of creating job</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><a href="https://dev.twitter.com/ads/analytics/metrics-and-segmentation" target="_parent" title="https://dev.twitter.com/ads/analytics/metrics-and-segmentation">https://dev.twitter.com/ads/analytics/metrics-and-segmentation</a></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/twitter-ads/resources/analytics.rb', line 119</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create_async_job'>create_async_job</span><span class='lparen'>(</span><span class='id identifier rubyid_account'>account</span><span class='comma'>,</span> <span class='id identifier rubyid_ids'>ids</span><span class='comma'>,</span> <span class='id identifier rubyid_metric_groups'>metric_groups</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='comment'># set default metric values
</span>  <span class='id identifier rubyid_end_time'>end_time</span>          <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='symbol'>:end_time</span><span class='comma'>,</span> <span class='lparen'>(</span><span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span> <span class='op'>-</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='period'>.</span><span class='id identifier rubyid_sec'>sec</span> <span class='op'>-</span> <span class='lparen'>(</span><span class='int'>60</span> <span class='op'>*</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='period'>.</span><span class='id identifier rubyid_min'>min</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_start_time'>start_time</span>        <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='symbol'>:start_time</span><span class='comma'>,</span> <span class='id identifier rubyid_end_time'>end_time</span> <span class='op'>-</span> <span class='int'>604_800</span><span class='rparen'>)</span> <span class='comment'># 7 days ago
</span>  <span class='id identifier rubyid_granularity'>granularity</span>       <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='symbol'>:granularity</span><span class='comma'>,</span> <span class='symbol'>:hour</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_start_utc_offset'>start_utc_offset</span>  <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:start_utc_offset</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:utc_offset</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_end_utc_offset'>end_utc_offset</span>    <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:end_utc_offset</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:utc_offset</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_placement'>placement</span>         <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='symbol'>:placement</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="../../TwitterAds.html#Placement-constant" title="TwitterAds::Placement (constant)">Placement</a></span></span><span class='op'>::</span><span class='const'>ALL_ON_TWITTER</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_segmentation_type'>segmentation_type</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='symbol'>:segmentation_type</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_country'>country</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='symbol'>:country</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_platform'>platform</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='symbol'>:platform</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_params'>params</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='label'>metric_groups:</span> <span class='id identifier rubyid_metric_groups'>metric_groups</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>,</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='label'>start_time:</span> <span class='const'><span class='object_link'><a href="../../TwitterAds.html" title="TwitterAds (module)">TwitterAds</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Utils.html" title="TwitterAds::Utils (module)">Utils</a></span></span><span class='period'>.</span><span class='id identifier rubyid_to_time'><span class='object_link'><a href="../Utils.html#to_time-class_method" title="TwitterAds::Utils.to_time (method)">to_time</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_start_time'>start_time</span><span class='comma'>,</span> <span class='id identifier rubyid_granularity'>granularity</span><span class='comma'>,</span> <span class='id identifier rubyid_start_utc_offset'>start_utc_offset</span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='label'>end_time:</span> <span class='const'><span class='object_link'><a href="../../TwitterAds.html" title="TwitterAds (module)">TwitterAds</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Utils.html" title="TwitterAds::Utils (module)">Utils</a></span></span><span class='period'>.</span><span class='id identifier rubyid_to_time'><span class='object_link'><a href="../Utils.html#to_time-class_method" title="TwitterAds::Utils.to_time (method)">to_time</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_end_time'>end_time</span><span class='comma'>,</span> <span class='id identifier rubyid_granularity'>granularity</span><span class='comma'>,</span> <span class='id identifier rubyid_end_utc_offset'>end_utc_offset</span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='label'>granularity:</span> <span class='id identifier rubyid_granularity'>granularity</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_upcase'>upcase</span><span class='comma'>,</span>
    <span class='label'>entity:</span> <span class='const'><span class='object_link'><a href="../Analytics.html#ANALYTICS_MAP-constant" title="TwitterAds::Analytics::ANALYTICS_MAP (constant)">ANALYTICS_MAP</a></span></span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='label'>placement:</span> <span class='id identifier rubyid_placement'>placement</span><span class='comma'>,</span>
    <span class='label'>country:</span> <span class='id identifier rubyid_country'>country</span><span class='comma'>,</span>
    <span class='label'>platform:</span> <span class='id identifier rubyid_platform'>platform</span>
  <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_compact'>compact</span>

  <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:segmentation_type</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_segmentation_type'>segmentation_type</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_upcase'>upcase</span> <span class='kw'>if</span> <span class='id identifier rubyid_segmentation_type'>segmentation_type</span>
  <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>entity_ids</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_ids'>ids</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>,</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

  <span class='id identifier rubyid_resource'>resource</span> <span class='op'>=</span> <span class='kw'>self</span><span class='op'>::</span><span class='const'>RESOURCE_ASYNC_STATS</span> <span class='op'>%</span> <span class='lbrace'>{</span> <span class='label'>account_id:</span> <span class='id identifier rubyid_account'>account</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>my resource is </span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_resource'>resource</span>
  <span class='id identifier rubyid_response'>response</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Request.html" title="TwitterAds::Request (class)">Request</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Request.html#initialize-instance_method" title="TwitterAds::Request#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_account'>account</span><span class='period'>.</span><span class='id identifier rubyid_client'>client</span><span class='comma'>,</span> <span class='symbol'>:post</span><span class='comma'>,</span> <span class='id identifier rubyid_resource'>resource</span><span class='comma'>,</span> <span class='label'>params:</span> <span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_perform'><span class='object_link'><a href="../Request.html#perform-instance_method" title="TwitterAds::Request#perform (method)">perform</a></span></span>
  <span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:data</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="fetch_async_job_data-instance_method">
  
    #<strong>fetch_async_job_data</strong>(data_url)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Fetch async job data for a completed job. Raises HTTP 404 exception,
otherwise retries up to 5 times with exponential backoff.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_response_data'>response_data</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../TwitterAds.html" title="TwitterAds (module)">TwitterAds</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../LineItem.html" title="TwitterAds::LineItem (class)">LineItem</a></span></span><span class='period'>.</span><span class='id identifier rubyid_fetch_async_job_data'>fetch_async_job_data</span><span class='lparen'>(</span><span class='id identifier rubyid_account'>account</span><span class='comma'>,</span> <span class='id identifier rubyid_file_url'>file_url</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>data_url</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The URL from the successful completion of an async job.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>A cursor of job statuses</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/twitter-ads/resources/analytics.rb', line 183</span>

<span class='kw'>def</span> <span class='id identifier rubyid_fetch_async_job_data'>fetch_async_job_data</span><span class='lparen'>(</span><span class='id identifier rubyid_data_url'>data_url</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_tries'>tries</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='kw'>begin</span>
    <span class='id identifier rubyid_tries'>tries</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='id identifier rubyid_raw_file'>raw_file</span> <span class='op'>=</span> <span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='id identifier rubyid_data_url'>data_url</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_unzipped_file'>unzipped_file</span> <span class='op'>=</span> <span class='const'>Zlib</span><span class='op'>::</span><span class='const'>GzipReader</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_raw_file'>raw_file</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_response_data'>response_data</span> <span class='op'>=</span> <span class='id identifier rubyid_unzipped_file'>unzipped_file</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span>
    <span class='id identifier rubyid_response'>response</span> <span class='op'>=</span> <span class='const'>JSON</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_response_data'>response_data</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_response'>response</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>data</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='kw'>rescue</span> <span class='const'>OpenURI</span><span class='op'>::</span><span class='const'>HTTPError</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
    <span class='kw'>unless</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_io'>io</span><span class='period'>.</span><span class='id identifier rubyid_status'>status</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>404</span><span class='tstring_end'>&#39;</span></span>
      <span class='kw'>if</span> <span class='id identifier rubyid_tries'>tries</span> <span class='op'>&lt;</span> <span class='int'>5</span>
        <span class='id identifier rubyid_sleep'>sleep</span><span class='lparen'>(</span><span class='int'>2</span><span class='op'>**</span><span class='id identifier rubyid_tries'>tries</span><span class='rparen'>)</span>
        <span class='kw'>retry</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="stats-instance_method">
  
    #<strong>stats</strong>(account, ids, metric_groups, opts = {})  &#x21d2; <tt>Array</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Pulls a list of metrics for a specified set of object IDs.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_ids'>ids</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>7o4em</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>oc9ce</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>1c5lji</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
<span class='id identifier rubyid_metric_groups'>metric_groups</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='const'>MetricGroups</span><span class='period'>.</span><span class='const'>MOBILE_CONVERSION</span><span class='comma'>,</span> <span class='const'>MetricGroups</span><span class='period'>.</span><span class='const'>ENGAGEMENT</span><span class='rbracket'>]</span>
<span class='id identifier rubyid_object'>object</span><span class='period'>.</span><span class='id identifier rubyid_stats'>stats</span><span class='lparen'>(</span><span class='id identifier rubyid_account'>account</span><span class='comma'>,</span> <span class='id identifier rubyid_ids'>ids</span><span class='comma'>,</span> <span class='id identifier rubyid_metric_groups'>metric_groups</span><span class='rparen'>)</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>account</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Account.html" title="TwitterAds::Account (class)">Account</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The Account object instance.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>ids</span>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A collection of object IDs being targeted.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>metric_groups</span>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>A collection of metric_groups to be fetched.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>An optional Hash of extended options.</p>
</div>
      
    </li>
  
</ul>

  
    
    
    
    
    
    
    
    
    <p class="tag_title">Options Hash (<tt>opts</tt>):</p>
    <ul class="option">
      
        <li>
          <span class="name">:start_time</span>
          <span class="type">(<tt>Time</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The starting time to use (default: 7 days ago).</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:end_time</span>
          <span class="type">(<tt>Time</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The end time to use (default: now).</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:granularity</span>
          <span class="type">(<tt>Symbol</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The granularity to use (default: :hour).</p>
</div>
          
        </li>
      
        <li>
          <span class="name">:placement</span>
          <span class="type">(<tt>Symbol</tt>)</span>
          <span class="default">
            
          </span>
          
            &mdash; <div class='inline'>
<p>The placement of entity (default: ALL_ON_TWITTER).</p>
</div>
          
        </li>
      
    </ul>
  

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The collection of stats requested.</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><a href="https://dev.twitter.com/ads/analytics/metrics-and-segmentation" target="_parent" title="https://dev.twitter.com/ads/analytics/metrics-and-segmentation">https://dev.twitter.com/ads/analytics/metrics-and-segmentation</a></li>
    
  </ul>
<p class="tag_title">Since:</p>
<ul class="since">
  
    <li>
      
      
      
      
        
        <div class='inline'>
<p>1.0.0</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/twitter-ads/resources/analytics.rb', line 70</span>

<span class='kw'>def</span> <span class='id identifier rubyid_stats'>stats</span><span class='lparen'>(</span><span class='id identifier rubyid_account'>account</span><span class='comma'>,</span> <span class='id identifier rubyid_ids'>ids</span><span class='comma'>,</span> <span class='id identifier rubyid_metric_groups'>metric_groups</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='comment'># set default metric values
</span>  <span class='id identifier rubyid_end_time'>end_time</span>          <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='symbol'>:end_time</span><span class='comma'>,</span> <span class='lparen'>(</span><span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span> <span class='op'>-</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='period'>.</span><span class='id identifier rubyid_sec'>sec</span> <span class='op'>-</span> <span class='lparen'>(</span><span class='int'>60</span> <span class='op'>*</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='period'>.</span><span class='id identifier rubyid_min'>min</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_start_time'>start_time</span>        <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='symbol'>:start_time</span><span class='comma'>,</span> <span class='id identifier rubyid_end_time'>end_time</span> <span class='op'>-</span> <span class='int'>604_800</span><span class='rparen'>)</span> <span class='comment'># 7 days ago
</span>  <span class='id identifier rubyid_granularity'>granularity</span>       <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='symbol'>:granularity</span><span class='comma'>,</span> <span class='symbol'>:hour</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_start_utc_offset'>start_utc_offset</span>  <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:start_utc_offset</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:utc_offset</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_end_utc_offset'>end_utc_offset</span>    <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:end_utc_offset</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:utc_offset</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_placement'>placement</span>         <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='period'>.</span><span class='id identifier rubyid_fetch'>fetch</span><span class='lparen'>(</span><span class='symbol'>:placement</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="../../TwitterAds.html#Placement-constant" title="TwitterAds::Placement (constant)">Placement</a></span></span><span class='op'>::</span><span class='const'>ALL_ON_TWITTER</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_params'>params</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='label'>metric_groups:</span> <span class='id identifier rubyid_metric_groups'>metric_groups</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>,</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='label'>start_time:</span> <span class='const'><span class='object_link'><a href="../../TwitterAds.html" title="TwitterAds (module)">TwitterAds</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Utils.html" title="TwitterAds::Utils (module)">Utils</a></span></span><span class='period'>.</span><span class='id identifier rubyid_to_time'><span class='object_link'><a href="../Utils.html#to_time-class_method" title="TwitterAds::Utils.to_time (method)">to_time</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_start_time'>start_time</span><span class='comma'>,</span> <span class='id identifier rubyid_granularity'>granularity</span><span class='comma'>,</span> <span class='id identifier rubyid_start_utc_offset'>start_utc_offset</span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='label'>end_time:</span> <span class='const'><span class='object_link'><a href="../../TwitterAds.html" title="TwitterAds (module)">TwitterAds</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Utils.html" title="TwitterAds::Utils (module)">Utils</a></span></span><span class='period'>.</span><span class='id identifier rubyid_to_time'><span class='object_link'><a href="../Utils.html#to_time-class_method" title="TwitterAds::Utils.to_time (method)">to_time</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_end_time'>end_time</span><span class='comma'>,</span> <span class='id identifier rubyid_granularity'>granularity</span><span class='comma'>,</span> <span class='id identifier rubyid_end_utc_offset'>end_utc_offset</span><span class='rparen'>)</span><span class='comma'>,</span>
    <span class='label'>granularity:</span> <span class='id identifier rubyid_granularity'>granularity</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_upcase'>upcase</span><span class='comma'>,</span>
    <span class='label'>entity:</span> <span class='const'><span class='object_link'><a href="../Analytics.html#ANALYTICS_MAP-constant" title="TwitterAds::Analytics::ANALYTICS_MAP (constant)">ANALYTICS_MAP</a></span></span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='label'>placement:</span> <span class='id identifier rubyid_placement'>placement</span>
  <span class='rbrace'>}</span>

  <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>entity_ids</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_ids'>ids</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>,</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

  <span class='id identifier rubyid_resource'>resource</span> <span class='op'>=</span> <span class='kw'>self</span><span class='op'>::</span><span class='const'>RESOURCE_STATS</span> <span class='op'>%</span> <span class='lbrace'>{</span> <span class='label'>account_id:</span> <span class='id identifier rubyid_account'>account</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_response'>response</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Request.html" title="TwitterAds::Request (class)">Request</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Request.html#initialize-instance_method" title="TwitterAds::Request#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_account'>account</span><span class='period'>.</span><span class='id identifier rubyid_client'>client</span><span class='comma'>,</span> <span class='symbol'>:get</span><span class='comma'>,</span> <span class='id identifier rubyid_resource'>resource</span><span class='comma'>,</span> <span class='label'>params:</span> <span class='id identifier rubyid_params'>params</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_perform'><span class='object_link'><a href="../Request.html#perform-instance_method" title="TwitterAds::Request#perform (method)">perform</a></span></span>
  <span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_body'>body</span><span class='lbracket'>[</span><span class='symbol'>:data</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Thu Feb 14 15:51:13 2019 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.12 (ruby-2.3.0).
</div>

    </div>
  </body>
</html>